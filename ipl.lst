     1                                  ; hello-os
     2                                  ; TAB=4
     3                                  
     4                                      ORG     0x7c00          ; このプログラムが何処によみこまれるのか
     5                                  
     6                                  ; 以下は標準的なFAT12フォーマットフロッピーディスクのための記述
     7                                  
     8 00000000 EB48                        JMP     entry
     9 00000002 90                          DB      0x90
    10 00000003 48454C4C4F49504C            DB      "HELLOIPL"
    11 0000000B 0002                        DW      512             ; 1セクタの大きさ                           (512にしなければならない)
    12 0000000D 01                          DB      1               ; クラスタの大きさ                          (1セクタにしなければならない)
    13 0000000E 0100                        DW      1               ; FATがどこから始まるか                     (普通は1セクタ目からにする)
    14 00000010 02                          DB      2               ; FATの個数                                 (2にしなければならない)
    15 00000011 E000                        DW      224             ; ルートディレクトリ領域の大きさ            (普通は224エントリにする)
    16 00000013 400B                        DW      2880            ; このドライブの大きさ                      (2880セクタにしなければならない)
    17 00000015 F0                          DB      0xf0            ; メディアタイプ                            (0xf0にしなければならない)
    18 00000016 0900                        DW      9               ; FAT領域の長さ                             (9セクタにしなければならない)
    19 00000018 1200                        DW      18              ; 1トラックにいくつのセクタがあるか         (18にしなければならない)
    20 0000001A 0200                        DW      2               ; ヘッドの数                                (2にしなければならない)
    21 0000001C 00000000                    DD      0               ; パーティションを使っていないのでここは必ず0
    22 00000020 400B0000                    DD      2880            ; このドライブの大きさをもう一度書く
    23 00000024 000029                      DB      0, 0, 0x29      ; よくわからないけどこの値にしておくといいらしい
    24 00000027 FFFFFFFF                    DD      0xffffffff      ; たぶんボリュームシリアル番号
    25 0000002B 48454C4C4F2D4F53            DB      "HELLO-OS"      ; ディスクの名前                            (11Byte)
    26 00000033 4641543132                  DB      "FAT12"         ; フォーマットの名前                        (8Byte)
    27 00000038 <res 00000012>              RESB    18              ; とりあえず18バイト開けておく
    27          ******************       warning: uninitialized space declared in .text section: zeroing
    28                                  
    29                                  ; Program Main Body
    30                                  
    31                                  entry:
    32 0000004A B80000                      MOV     AX,0            ; レジスタ初期化
    33 0000004D 8ED0                        MOV     SS,AX
    34 0000004F BC007C                      MOV     SP,0x7c00
    35 00000052 8ED8                        MOV     DS,AX
    36 00000054 8EC0                        MOV     ES,AX
    37                                  
    38 00000056 BE[6E00]                    MOV     SI,msg
    39                                  putloop:
    40 00000059 8A04                        MOV     AL,[SI]
    41 0000005B 83C601                      ADD     SI,1            ; SIに1を足す
    42 0000005E 3C00                        CMP     AL,0
    43 00000060 7409                        JE      fin
    44 00000062 B40E                        MOV     AH,0x0e         ; 一文字表示ファンクション
    45 00000064 BB0F00                      MOV     BX,15           ; カラーコード
    46 00000067 CD10                        INT     0x10            ; ビデオBIOS呼び出し
    47 00000069 EBEE                        JMP     putloop
    48                                  fin:
    49 0000006B F4                          HLT                     ; 何かアルバでCPUを停止させる
    50 0000006C EBFD                        JMP     fin             ; 無限ループ
    51                                  
    52                                  msg:
    53 0000006E 0A0A                        DB      0x0a, 0x0a      ; 改行を2つ
    54 00000070 68656C6C6F2C20776F-         DB      "hello, world"
    54 00000079 726C64             
    55 0000007C 0A                          DB      0x0a            ; 改行
    56 0000007D 00                          DB      0
    57                                  
    58                                      ;RESB    0x7dfe-$        ; エラーになる。。。
    59 0000007E <res 00000180>              RESB	0x7dfe-0x7c00-($-$$)		; 0x7dfeまでを0x00で埋める命令
    59          ******************       warning: uninitialized space declared in .text section: zeroing
    60 000001FE 55AA                        DB      0x55, 0xaa
    61                                  
    62                                  
    63                                  ; 以下はブートセクタ以外の部分の記述
    64                                  
    65 00000200 F0FFFF0000000000            DB      0xf0, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00
    66 00000208 <res 000011F8>              RESB    4600
    66          ******************       warning: uninitialized space declared in .text section: zeroing
    67 00001400 F0FFFF0000000000            DB      0xf0, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00
    68 00001408 <res 00166BF8>              RESB    1469432
    68          ******************       warning: uninitialized space declared in .text section: zeroing
